---
layout: post
title:  "漫话云计算（二） —— 百舸争流的公有云"
categories: 编程随想
---


## 让故事继续

还记得 [漫话云计算(一)——简介与起源](http://bbs.meili-inc.com/forum.php?mod=viewthread&tid=4151) 的开篇故事吗？那时有个好想法的你正在走向改变世界的路上。你的事业蒸蒸日上，颇具市场规模，研发项目成百上千，因而也需要成千上万台服务器。出于数据安全的需要，这些服务器通常由自己采购和维护。那么问题来了：

- 资源利用低：为了避免冲突，每个研发应用都需要分配独占的物理机。通常这些物理机的配置远远超出应用的实际需求，导致物理机资源利用率低下，意味着浪费成本。
- 资源交付慢：每当你需要服务器，长着需要数周的采购上架，短着数个小时的系统安装和交付。

虚拟化技术面世于上世纪 60 年代，之后很长的一段时间里不愠不火；直到十年前，因虚拟化良好的解决上述问题，它逐步赢得大众青睐。虚拟化技术在单个物理机上创建多个虚拟机，对开发人员而言，虚拟机和物理机无任何区别，然后根据业务实际要求分配相应配置的虚拟机。同时，你需要一个管理平台，这套平台能够管理成千上万，乃至数十万虚拟机的生命周期，我们称这套平台叫私有云。随着功能的逐步丰富，私有云平台不仅仅能管理虚拟机，还能管理容器／数据库／缓存／消息中间件等服务。在这套平台上，用户可以在数秒内创建所需要的资源。

终于，你踏过千山万水，迈过荆棘丛林，筚路蓝缕，在纳斯达克敲响了怒放的生命。不仅如此，你的企业还成为了行业的 big boss，如果你恰好是电商，你会有促销节，促销节那天，你的流量是平常的几十倍，如果说平日需要 1 万台服务器支撑业务，那么促销节那天你可能需要 30 万台服务器才能支撑业务，意味着 29 万台服务器在平日处于闲置状态。29 万台服务器，那可是上百亿人民币啊。精明的你马上会想到：如果我把私有云对外开放收费，那么这些闲置的服务器不就利用起来了嘛？事实上，AWS 正是这样演化而来，而且溜的飞起，产生了巨大的商业价值，隔壁的 Microsoft，Google 争先恐后加入到这个行业，意图分上一份蛋糕。其实世上本没有这个行业，玩的厂商多了，也便有了公有云行业。最终，云计算是要演变成一个生态圈，它是能集成上下游的产业链，各个厂商都可以在中间找到很多商机，最终能让用户和服务提供商形成良性的互动。

这个故事介绍了一家企业在成长过程面临的 IT 资源问题。在初创阶段，公有云往往是最佳的选择，因为初期成本投入底，资源获取快。在颇具规模阶段，私有云往往是更佳的选择，因为达到一定规模后，私有云的成本比公有云低，此外数据安全也是采用私有云的因素之一。企业成熟后，亦可对外提供云服务，增加收入。从中我们可以看到：规模／成本／效率／安全等因素，是决定 IT 资源形态的重要标准。

## 公有云的产品与厂商

### 产品

每当一个行业出现的时候，总是需要焕然一新的词语和充满想象的概念。没有哪个公有云厂商会说：

> 我是卖云主机(虚拟机)，卖存储的...

你应该用高大上的词语来介绍你的业务：

> 我们卖的是服务！(We are service providers.)

在一切皆服务（Everyting As A Service，XaaS）的理念下，早期的公有云诞生出了云主机／私有网络 VPC／块存储／文件存储／对象存储／数据库／中间件等基础服务，这些基础设施背后的技术栈，就是虚拟化。在这片红海中，公有云厂商为了提升竞争力和价值，又逐步提供视频处理／图像处理／物联网／移动应用等服务。下图是领头羊 AWS 的部分服务类型：

![](http://wsfdl.oss-cn-qingdao.aliyuncs.com/aws_product.png)

鉴于篇幅，本文仅简要阐述部分服务：

- 计算：云主机，容器，函数服务等等
- 存储：云硬盘，文件系统，对象存储，关系型数据库，多种 NoSQL，缓存等等
- 网络：VPC，网关，专线，CDN，VPN 等等
- PaaS／SaaS：大数据，消息中间件，消息通知，版本管理／发布／CI／CD 等等

AWS 服务之丰富，涵盖范围之广，下至 IaaS，上至 SaaS，无论移动端，还是服务端，都有相应的产品服务。所以公有云目前对小微企业、初创企业的吸引力是最大的，因为它把整个创业的门槛降低，特别是加快了互联网产品的发布速度。

### 厂商

从 2016 年 Gartner 发布的公有云魔力象限图可以看出，AWS／Google／Microsoft 是最重要的三大玩家。

![](http://wsfdl.oss-cn-qingdao.aliyuncs.com/garnter_2016.png)

AWS 开拓了公有云的商业模式，并取得辉煌的成就，前文已用大幅篇章介绍之。

凭借 Windows 和大规模的数据中心，微软在企业数据中心上有着得天独厚的优势。做为后起之秀，微软把握住时机并充分的利用优势快速发展。根据微软 2017 Q3 的财报，微软的主要增长动力来自于云计算部门，该部门营收达到67亿美元，与上年同期增长 11%，而 Azure 的销售额更是同期增长了 93%。

谷歌拥有非常广阔的成长空间。大规模发展生产环境下的容器部署让其在 PaaS 积累了充分的技术和经验，这要归功于 Linux 在容器规范上的前期工作以及每周启动数十亿台容器的经验。虽然谷歌从未正式透露过云计算业务的规模，也没有公布云服务财报，好事之分析师估算 Google Cloud 2016 年的营收规模约为 10 亿美元。

## 阿里云

在本文的最后一节，让我们谈谈国内公有云的最大玩家——阿里云。如果说 AWS 是自然演变过来的，那么阿里云则是为了做云而做云，这也注定它的坎坷之路。

2009 年是阿里巴巴集团十周年，在那个纪念日上，老马敲响的锣鼓宣告了阿里云的成立。那时张口大数据闭口大数据的阿里对 hadoop 情有独钟，意图把整套平台架设在 hadoop 上，为早期引发的性能问题埋下隐患——那是一套连阿里体系都不愿意使用的平台。由于缺乏充足的经验和面对技术难题，阿里云存储和网络方案多次推倒重来，产品迟迟不稳定，内部的质疑声愈发强烈，大众给王坚博士贴上了“骗子”的标签。特别在 2012 年，他一时成为了阿里最受争议的人，虽然有老马的站背：

> 请相信博士（王坚），给他一点时间。

但更多的是员工们离职的浪潮：

> 我觉得在干下去，也看不到任何希望

正如罗曼·罗兰所说：最可怕的敌人，就是没有坚强的信念。王博士的信念，强大到长期挨批挨斗到痛苦失声也不放弃。艰难困苦，玉汝于成，阿里云用了 6 年的时间逐步解决大大小小的问题，逐步演化出一套功能稳定，产品齐全，性能也不错的云平台。笔者依旧记得，在 2015 年第一届“云栖大会”，阿里云发布了琳琅满目的产品，那一天，阿里云腾飞了！此后的季度里，阿里云保持年近 120% 的增长率，预计 2017 全年营收将达到 AWS 在 2011 年的水平。

时至今日，阿里云在国内一枝独秀，40% 的市场份额超越第二、三、四名之和，并将逐步走向盈利。反观国内其它同行企业，因为公有云前期投入巨大，短期内难以盈利，所以今后会是大鱼吃小鱼，更趋同质化的竞争。这也是为什么中小型的公有云厂商，像青云、UCloud、迅达云等厂商近期纷纷融资，因为粮草是打赢这场消耗战最基本的前提。

![](http://wsfdl.oss-cn-qingdao.aliyuncs.com/aliyun_revenue.png)

8 年已去，阿里云的工程师换了 5 代(长期 996，多次 3.25)，岁月见证了它现在的成就和曾经的艰难。让我们做个事后诸葛亮，分析阿里云的成功之道：

1. 电商基因：电商业务的峰值和峰谷存在巨大差异，一套云平台可以最大程度利用 IT 资源，节约 IT 成本，并且提升研发效率。
2. 资本雄厚：公有云要求技术经验丰富，IT 资产投入高，研发周期长等特点，阿里巴巴雄厚的资本为阿里云赢得这场战争提供了充裕粮草。
3. 领导者：嗅觉敏锐，目光长远的老马给了阿里云充裕的时间／人力／金钱，信念坚定，深谙技术本质的王博士成功的获得领导的支持。他们互相成就了一段贤主良臣的佳话。
4. 人才与经验：阿里云集中了阿里巴巴大批优秀的技术人才，淘宝天猫等平台的技术积累为阿里云提供了必要的技术基础。
